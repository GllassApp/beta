<!DOCTYPE html>
<html>

<head>
    <title>Gllass Â· Home</title>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script>
    <script type="text/javascript">
    new WOW().init();
    </script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="mobile-web-app-capable" content="yes">
</head>

<body>
    <div class="element">
        <div class="container">
            <h1><i class="fa fa-circle-o-notch rotate"></i> Training...</h1>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.js"></script>
    <script type="text/javascript">
    hash = window.location.hash;
    // Get the access token
    hashParts = hash.split('=');
    token = hashParts[1];
    // Get the user
    tokenParts = token.split('.');
    user_id = tokenParts[0];
    // Send access token to server
    $.ajax({
        type: 'POST',
        complete: function(data) {
            window.location = "upload.html"
        },
        contentType: 'application/json; charset=utf-8',
        url: 'http://53f6a570.ngrok.io/register-account',
        data: JSON.stringify({
            token: token,
            user_id: user_id
        }),
        dataType: 'json'
    });
    </script>
    <script src="https://www.gstatic.com/firebasejs/3.6.1/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/3.6.1/firebase-database.js"></script>
    <script>
    // Initialize Firebase
    var config = {
        apiKey: "AIzaSyDL9W8bdP3mpbHhG_D_j5f98lAueFC8Rm0",
        authDomain: "gllass-b160f.firebaseapp.com",
        databaseURL: "https://gllass-b160f.firebaseio.com",
        storageBucket: "gllass-b160f.appspot.com",
        messagingSenderId: "36884393381"
    };
    firebase.initializeApp(config);
    var database = firebase.database();

    function writeNewUser(uid) {
        // A post entry.
        var userData = {
            uid: uid
        };

        // Get a key for a new Post.
        var newUserKey = firebase.database().ref().child('users').push().key;

        // Write the new post's data simultaneously in the posts list and the user's post list.
        var updates = {};
        updates['/users/' + newUserKey] = userData;
        updates['/user-posts/' + uid + '/' + newPostKey] = postData;

        return firebase.database().ref().update(updates);
    }
    </script>
</body>

</html>
